%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% StuPro B, "Programmierumgebung Offener Antrieb" (POA)
%% Anforderungen
%% $Id: anforderungen.tex,v 1.2 2003/05/31 16:44:11 garbeam Exp $
%% Achtung: Diese Datei wird ins Angebot inkludiert!
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Anforderungen
\chapter{Anforderungen}
Dieses Kapitel beschreibt die Anforderungen des Kunden an das
Studienprojekt B, ''Programmierumgebung Offener Antrieb'' (POA).

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Hintergrund
\section{Hintergrund}
Es werden viele Neuentwicklungen im Bereich der Werkzeugmaschinen gemacht.
Viele dieser Entwicklungen beinhalten neue Kinematiken, wie z.B. die
Parallelkinematiken und Sensoren (z.B. den Ferraris 
Relativbeschleunigungssensor).\par
Dadurch entstehen neue Anforderungen an die Antriebsregelung. Zusättzliche
Sensor-Signale müssen in den Reglerstrukturen berücksichtigt werden - oder
sogar völlig neue Reglerstrukturen werden benötigt.\par
Die momentan auf dem Markt erhältlichen Reglersysteme erlauben meist
weder die Berücksichtigung neuartiger Sensoren, noch bieten sie die
Möglichkeit, eigene anwenderspezifische Reglerstrukturen zu implementieren.\par
Daher wird am ISW eine Plattform für die Antriebsregelung entwickelt,
auf der es dem Anwender in jeder Hinsicht offen steht, eigene Funktionalitäten
zu integrieren. Diese Plattform wird am ISW kurz als ``Offener Antrieb''
bezeichnet.  \par
Die hardwaretechnische Realisierung erfolgt in Form einer PC-Einsteckplatine.
Zentrales Element des Offenen Antriebes ist der Altera ``APEX''Baustein. Es
handelt sich dabei um einen CPLD\footnote{Complex Programmable Logic Device},
der sich frei programmieren lässt. Der Anwender hat die Möglichkeit, die
Funktion des Bausteins seinen Bdürfnissen anzupassen.\par
Um die Offenheit für jeden Anwender nutzbar zu machen, wird für den CPLD eine
Architektur festgelegt, die es ermöglicht, einzelne Funktionalitäten in Form
von Modulen zu implementieren. Diese Modlue können aus festprogrammierten
Schaltungen (Cores) und freiprogrammierbaren CPUs bestehen. Jedes Modul kann
auf die Signale aller anderen Module zugreifen und stellt seine eigenen
Ausgangsignale allen anderen Modulen zur Verfügung.\par
Inhalt dieses Angebotes ist es, eine Programmierumgebung für das Netzwerk
von CPUs und Cores zu schaffen, in dem ein bereits auf dem CPLD vorhandenes
Netzwerk konfiguriert werden kann. Es soll in der grafischen Oberfläche
erkennbar sein, welche Ein- und Ausgänge die einzelnen CPUs und Cores
haben. Des Weiteren sollen den CPUs C-Sourcen zugeordnet werden und diese
für die CPU kompiliert und auf das offene Antriebsboard heruntergeladen
werden können.
 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% GUI
\section{GUI}

Die Oberfläche von POA untergliedert sich in folgende Teilbereiche:
\begin{itemize}
\item Grafisches Hauptfenster das alle Module des CPLD abbildet
\item Modulbibliothek
\item Funktionsblockkonfigurationsdialog 
\item externer Editor
\item Optimierungsdialog
\item externes Compilierterminal
\item CPLD-Download Dialog
\item Konfigurationsdialog
\end{itemize}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Hauptfenster
\subsection{Hauptfenster}
Im Hauptfenster werden die Funktionsblöcke (CPU, Cores, E/A-Blöcke) sowie
Signalleitungen in einem rasterisiertem Layout dargestellt und mit Maus- und
Tastatureingaben bearbeitet.\par
Desweiteren werden Funktionsblöcke aus der Modulbibliothek via Drag\&Drop in
das Hauptfenster gezogen oder entfernt. Die Verknüpfung zwischen den
Funktionsblöcken geschieht durch ziehen von Signalleitungen (Linien) mit der
Maus.\newline
Durch Doppelklick auf einen Funktionsblock öffnet sich der
Funktionsblockkonfigurationsdialog.\newline
Im Menü des Hauptfensters wird ein konfiguriertes Layout gespeichert oder
geöffnet. Alle Dialoge sind über die Toolbar und Menüleiste aufrufbar. 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Modulbibliothek
\subsection{Modulbibliothek}
Befindet sich angedockt am Rand des Hauptfensters und stellt eine Liste aller
in der Bibliothek enthaltenen CPU- und Coreblöcke dar. Die Darstellung der
CPUs und Cores in dieser Liste (Baumdiagramm CPU/Cores?) ist noch ungeklärt.
Die CPU- und Coreblöcke können via Drag\&Drop ins Hauptfenster gezogen werden.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Funktionsblockkonfigurationsdialog
\subsection{Funktionsblockkonfigurationsdialog}
Folgende Funktionsblockparameter können in diesem Dialog konfiguriert werden:
\begin{itemize}
\item Anzahl der Signal-Ein/Ausgänge (Bezeichner?) 
\item Verknüpfungen an E/As?
\item Zeitoffset einstellen
\item Taktrate einstellen
\item externen Editor aufrufen
\end{itemize}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Externer Editor
\subsection{Externer Editor}
Bietet Editierung des zum CPU-Block gehörenden Sourcecodes an. Durch
Einbindung einer Template-Sourcecode Datei wird bei erstmaliger Editierung
ein vorgenerierter Rahmencode erzeugt und im Editor dargestellt.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Optimierungsdialog
\subsection{Optimierungsdialog}
Dieser Dialog bietet die Ausführung der folgenden Schritte an:
\begin{itemize}
\item Plausibilitätsprüfung der Signalverknüpfungen
\item Signallaufzeitbestimmung
\item Laufzeitoptimierung
\end{itemize}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% externen Compilierterminal
\subsection{externes Compilierterminal}
Der Compiliervorgang der CPLD-Konfiguration wird in einem externen Terminal
aus einer Menüfunktion heraus gestartet.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% CPLD-Download Dialog
\subsection{CPLD-Download Dialog}
Bietet Auswahl downloadbarer (vorkompilierter) Funktionsblöcke an und startet
den Downloadvorgang in externem Terminal.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Konfigurationsdialog
\subsection{Konfigurationsdialog}
Der Konfigurationsdialog bietet die Konfiguration von POA an, u.a. Einstellung
des externen Editors, des Compilers, des externes Terminals, des C-Sourcecode-
Templates und des CPLD-Downloads.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Interfaces
\section{Interfaces}

POA unterstützt folgende Interfaces:
\begin{itemize}
\item externer Editor
\item Signallaufzeitbestimmung
\item Compiler
\item CPLD-Download Tool
\end{itemize}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% externer Editor
\subsection{externer Editor}
Schnittstelle zum Betriebssystem über temporäre Sourcedatei.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Signallaufzeitbestimmung
\subsection{Signallaufzeitbestimmung}
Schnittstelle zum Betriebssystem über spezielles Programm und evtl.
temporäre Resultatdatei (noch ungeklärt).

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Compiler
\subsection{Compiler}
Schnittstelle zum Betriebssystem über Compilerprogramm (gcc?).

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% CPLD-Download
\subsection{CPLD-Download}
Schnittstelle zum Betriebssystem über spezielles Downloadprogramm für
serielle Schnitstelle (näheres noch ungeklärt).

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Algorithmen
\section{Algorithmen}

POA enthält folgende erwähnenswerte zu entwickelnde/einzubindende Algorithmen:
\begin{itemize}
\item Laufzeitoptimierungsalgorithmus (Scheduling)
\item Darstellungsalgorithmus des CPLD-Layouts
\item Speichern und Öffnen von konfigurierten CPLD-Layouts und Sourcen via XML
\end{itemize}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Formate
\section{Formate}

POA nutzt folgende Formate:

\begin{itemize}
\item spezielles XML Format zum Speichern und Öffnen von CPLD-Layouts
\item C-Sourcecode Dateien der CPU-Blöcke in geeigneter Verzeichnisstruktur
\item Ergebnisse der Signallaufzeitbestimmung in externer Datei?
      (noch ungeklärt)
\item Object-Code (ELF?) für compilierte CPU-Blöcke
\item spezielles Headerformat für CPLD-Download (noch ungeklärt)
\item Output des Compilers (stdout)
\item Output des CPLD-Downloads (stdout)
\end{itemize}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% XML
\subsection{XML}
Ein spezielles XML Format wird zum Speichern und Öffnen von
CPLD-Layout-Konfigurationen verwendet.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Sourcecode der CPU-Blöcke
\subsection{Sourcecode der CPU-Blöcke}
Es wird ein vorkonfigurierbares C-Template als Vorlage für
Rahmencodeerzeugung der CPU-Blöcke verwendet. Der Sourcecode von CPU-Blöcken
wird in einer geeigneten Verzeichnisstruktur abgelegt.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Background

